<!doctype html>
<!-- <html manifest="appcache/offlinify.appcache"> -->
<html>

  <head>
    <title>Offline Application</title>
    <link rel="stylesheet" href="css/semantic.min.css">
    <link href='https://fonts.googleapis.com/css?family=Pacifico' rel='stylesheet' type='text/css'>
    <link rel="icon" type="image/ico" href="icon.ico">
    <style> .off { opacity: 0.75; } .pacifico { font-family: 'Pacifico', sans-serif; font-weight: 400;} .ui.card, .ui.cards>.card { width: 271px; }</style>
  </head>

  <body ng-app="offlineApp">

    <div ng-controller="mainCtrl">

      <div class="ui stackable fixed inverted menu">
        <div class="header item"><h3 class="pacifico">Offlinify</h3></div>
        <a class="item" ng-click="forceRefresh()"><i class="ui refresh icon"></i> Force Refresh</a>
        <a class="item" ng-click="wipeIndexedDB()"><i class="ui database icon"></i> Wipe IndexedDB</a>
        <a class="item" ng-click="switchDataSource()"><i class="ui database icon"></i> Switch Datasource</a>
        <div class="right menu">
          <div class="item">
            <form class="ui inverted action input" ng-submit="objectUpdate(candidateItem, 'cars')">
              <input type="text" ng-model="candidateItem.fields.name" placeholder="Enter a new item">
              <button class="ui button" type="submit">Create</button>
            </form>
          </div>
        </div>
      </div>

      <div class="ui grid centered container">

        <div class="row"></div>

        <div class="ui segment">
          <h3>Diagnostics</h3>

        </div>

        <div class="row"></div>

        <div class="row">

          <div class="twelve wide center aligned column">

            <div class="ui info message">
              <i class="close icon"></i>
              <p></p>
              <div class="header"><h2>Say hello to <span class="pacifico">offline</span>.</h2></div>
              <p></p>

              <p> Below should show JSON data taken from the offlinify API. Returns
                  real data on GET requests, and simulated 200 response on POSTs.
                  The meat of Offlinify is the js/services/offlineService.js file.
                  Edit the config to match your own API. Note: ISO-8601
                  (ECMAScript 5) timestamps are required for Offlinify to work.</p>
              <p> IndexedDB is automatically written to on create/update requests,
                  unless if IDB is not supported by your browser. Tip: true offline
                  capability would be made possible by using
                  <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Using_the_application_cache">AppCache</a>
                  to persistently store your static files.</p>
            </div>

          </div>

        </div>

        <div class="row"></div>

        <div class="sixteen wide center aligned column">

          <div class="ui cards">
            <div ng-class="{'card': true, 'off': !item.fields.clicked}" ng-if="!item.fields.deleted" ng-repeat="item in dataModel">
              <div class="content">
                <i class="close link right floated icon" ng-click="item.fields.deleted = true"></i>
                <div class="header">{{ item.fields.name }}</div>
                <div class="meta">
                  <h6>{{item.timestamp}}</h6>
                </div>
              </div>
              <div class="extra content">
                <div class="ui two buttons">
                  <div class="ui grey button" ng-click="item.fields.clicked = false; objectUpdate(item, 'cars')" ng-class="{'basic' : item.fields.clicked}">Off</div>
                  <div class="ui button" ng-click="item.fields.clicked = true; objectUpdate(item, 'cars')" ng-class="{'basic' : !item.fields.clicked, 'teal' : item.fields.clicked, 'grey' : !item.fields.clicked}">On</div>
                </div>
              </div>
            </div>
          </div>

        </div>
        <div class="row"></div>
      </div>

  </div>

    <script src="lib/angular.min.js"></script>
    <script src="lib/jquery.min.js"></script>
    <script src="lib/notify.min.js"></script>
    <script src="lib/indexeddbpolyfill.min.js"></script>
    <script src="lib/lodash.js"></script>

    <script src="css/semantic.min.js"></script>

    <script src="js/app.js"></script>
    <script src="js/controllers/mainCtrl.js"></script>
    <script src="js/services/offlineService.js"></script>
    <script src="js/directives/card.js"></script>

    <script>
    $('.message .close')
      .on('click', function() {
        $(this)
          .closest('.message')
          .transition('fade')
        ;
      });
    </script>

  </body>
</html>
